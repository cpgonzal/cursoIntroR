<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Profesores:  Marcos Colebrook Santamaría  Carlos Pérez González" />
  <title>Curso de introducción al software estadístico R  </title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" type="text/css" media="screen, projection, print"
    href="http://www.w3.org/Talks/Tools/Slidy2/styles/slidy.css" />
  <script src="http://www.w3.org/Talks/Tools/Slidy2/scripts/slidy.js.gz"
    charset="utf-8" type="text/javascript"></script>
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">Curso de introducción al software estadístico R </br> <img src="figure/Rlogo.jpg" /></h1>
  <p class="author">
Profesores: </br> Marcos Colebrook Santamaría </br> Carlos Pérez González
  </p>
  <p class="date">Área de Estadística e Investigación Operativa - Universidad de La Laguna </br> Curso de Fundación Canaria General, 2014</p>
</div>
<div id="bienvenidos-a-r" class="slide section level1">
<h1>Bienvenidos a R</h1>
<h2 id="contenidos">Contenidos</h2>
<ol style="list-style-type: decimal">
<li>Introducción al entorno R: instalación y uso básico. Librerías.</li>
<li>Conceptos básicos del lenguaje R: instrucciones sencillas, scripts y funciones sencillas.</li>
<li>Introducción a la interfaz Rstudio.</li>
<li>Gráficos en R: el comando plot() y librerías específicas.</li>
<li>Librería RCommander y técnicas de análisis estadístico.</li>
</ol>
</div>
<div id="introducción-al-entorno-r-instalación-y-uso-básico.-librerías." class="slide section level1">
<h1><br/><br/><br/><br/>Introducción al entorno R: instalación y uso básico. Librerías.</h1>
</div>
<div id="qué-es-r-y-qué-es-lo-que-no-es-i" class="slide section level1">
<h1>¿Qué es R (y qué es lo que no es)? (I)</h1>
<ul>
<li>R es un entorno de libre acceso para computación estadística y gráficos así como para programación. Tiene una serie de características que lo hacen bastante asequible cuando empezamos a trabajar por primera vez con él.
<ul>
<li>Utiliza un lenguaje muy bien desarrollado pero simple.</li>
<li>Su funcionalidad es la de un intérprete de comandos (se ejecutan las instrucciones a medida que las introducimos) y la de un lenguaje de programación (se puede realizar un script o conjunto de instrucciones a modo de programa).</li>
<li>La instalación por primera vez proporciona un entorno básico de R casi sin ninguna dificultad.</li>
<li>Permite un rápido desarrollo de nuevas herramientas para resolver problemas.</li>
<li>Estos desarrollos se distribuyen en forma de librerías que cualquier usuario puede descargar e instalar para personalizar su propio entorno de R.</li>
</ul></li>
</ul>
<ul>
<li>R no es un lenguaje de programación que permita realizar aplicaciones ejecutables. Sin embargo, se pueden programar interfaces gráficas para facilitar el uso de los programas a los usuarios pero es preciso que estos tengan instalado R.</li>
</ul>
</div>
<div id="qué-es-r-y-qué-es-lo-que-no-es-y-ii" class="slide section level1">
<h1>¿Qué es R (y qué es lo que no es)? (y II)</h1>
<object data="figure/Rdiagram.svg" type="image/svg+xml" 
  width="80%" height="80%" title="Esquema R y librerías"> 
</object>


</div>
<div id="en-qué-me-puede-ayudar" class="slide section level1">
<h1>¿En qué me puede ayudar?</h1>
<ul>
<li>Tenemos miedo a utilizar esto y luego venga otra cosa que lo sustituya....</li>
</ul>
<ul>
<li>Sin embargo, si lo pensamos tranquilamente, muchas de las cosas que necesitamos hacer habitualmente (gráficas, problemas de estadística, etc..) no necesitan de un software complicado (SPSS, SAS, etc..).</li>
</ul>
<ul>
<li>Podemos utilizar R para resolver de forma más o menos fácil (depende de lo que hayamos entendido en clase de estadística) muchos de estos problemas. A medida que uno desarrolle trabajos de más dificultad (trabajos, proyectos fin de grado o máster, investigación, etc..) R nos será de mayor utilidad.</li>
</ul>
</div>
<div id="por-donde-empezamos-r-base-y-librerías-o-paquetes.-rstudio" class="slide section level1">
<h1>¿Por donde empezamos? R Base y librerías o paquetes. Rstudio</h1>
<ul>
<li>En principio, se comienza descargando el paquete básico de R (Base R)
<ul>
<li>Ir a www.r-project.org(http://www.r-project.org) y descarga la versión de RStudio para tu OS.</li>
</ul></li>
</ul>
<ul>
<li>El paquete base viene con un conjunto de herramientas básicas de gestión de datos, análisis y funciones gráficas.</li>
</ul>
<ul>
<li>A medida que uno necesita más herramientas, se pueden descargar e instalar entre las +4000 librerías que hay en CRAN las que puedan sernos de ayuda.
<ul>
<li>Una librería que utilizaremos en este curso es Rcmdr (RCommander). La instalaremos desde el terminal de comandos de R.</li>
</ul></li>
</ul>
<ul>
<li>R se puede utilizar básicamente con lo que tenemos en la instalación base (terminal de comandos) pero podemos instalar, de forma adicional, algún otro entorno gráfico que facilite su uso (Rstudio).
<ul>
<li>Ir a www.rstudio.org(http://www.rstudio.org) y descarga la versión de RStudio para tu OS.</li>
</ul></li>
</ul>
</div>
<div id="ya-tengo-esto-instalado...." class="slide section level1">
<h1>Ya tengo esto instalado....</h1>
<ul>
<li>Empezaremos adquiriendo conocimientos básicos de R.
<ul>
<li>Se trata de iniciarse en el manejo de R (comienza como exploreR para llegar a ser un useR). Hay excelentes tutoriales en internet para mejorar aprendizaje.
<ul>
<li>Por ejemplo, codeschool tiene este tutorial <a href="http://tryr.codeschool.com/levels/1/challenges/1">online R</a> para ensayar con R solo con el navegador, sin necesidad de instalar nada.</li>
<li>Hay muchos recursos como <a href="http://www.nceas.ucsb.edu/files/scicomp/Dloads/RProgramming/BestFirstRTutorial.pdf">tutorial auto-aprendizaje</a> o <a href="https://wiki.ucl.ac.uk/display/~uctpfos/R-Resources">UCL wiki</a>.</li>
</ul></li>
</ul></li>
</ul>
<ul>
<li>Aunque la curva de aprendizaje de R puede ser pronunciada, el soporte de la comunidad de usuarios es muy grande.
<ul>
<li>La comunidad es muy activa en foros, páginas web,...</li>
<li>Buscar en Google una duda siempre retorna algo útil.</li>
<li>Familiarízate con <a href="http://www.stackoverflow.com">stackoverflow</a></li>
<li>Si conoces otro software, hay bastante ayuda para el paso a R
<ul>
<li><a href="http://dss.princeton.edu/training/RStata.pdf">R para usuarios Stata</a></li>
<li><a href="http://cran.r-project.org/doc/contrib/Hiebeler-matlabR.pdf">R para usuarios Matlab</a></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="conceptos-básicos-del-lenguaje-r-instrucciones-sencillas-scripts-y-funciones-sencillas." class="slide section level1">
<h1><br/><br/><br/><br/>Conceptos básicos del lenguaje R: instrucciones sencillas, scripts y funciones sencillas.</h1>
</div>
<div id="la-consola-de-r.-operaciones-elementales" class="slide section level1">
<h1>La consola de R. Operaciones elementales</h1>
<ul>
<li>El código R puede ser introducido directamente en la consola de comandos o mediante un script. Por ejemplo, se pueden realizar operaciones aritméticas elementales</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># operaciones básicas</span>
<span class="dv">7</span> +<span class="st"> </span><span class="dv">3</span>
<span class="dv">7</span> *<span class="st"> </span><span class="dv">3</span>
<span class="dv">7</span>/<span class="dv">3</span>
<span class="dv">7</span>%%<span class="dv">3</span>
<span class="dv">7</span>/<span class="dv">0</span></code></pre>
<ul>
<li>Observar que los comandos están separados con un salto de línea (o también con <code>;</code>). Sin embargo, si el comando comienza con el caracter <code>#</code> esa línea no se ejecuta (p.e., apropiado para añadir comentarios explicativo)</li>
</ul>
<ul>
<li>Todo en R (variables, vectores, funciones, gráficos, fórmulas, ...) son objetos.</li>
</ul>
</div>
<div id="la-consola-de-r.-operaciones-elementales-ii" class="slide section level1">
<h1>La consola de R. Operaciones elementales (II)</h1>
<ul>
<li>El objeto más elemental es una variable. Para crear una variable (x) debemos asignar un valor (número, palabra, ...) mediante <code>&lt;-</code> or <code>=</code> . Se recomienda <code>&lt;-</code> .</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">3</span></code></pre>
<ul>
<li>Tengamos en cuenta que R es sensible a mayúsculas: <code>x</code> es diferente de <code>X</code></li>
</ul>
<ul>
<li>Una reasignación sobreescribe el contenido de la variable</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> &quot;ahora x es una cadena.&quot;</span>
x
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>)  <span class="co"># c() combina valores en un vector.</span>
x</code></pre>
<ul>
<li>Acceder a elementos de un vector <code>x</code> con <code>x[n]</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">x
x[<span class="dv">3</span>:<span class="dv">6</span>]  <span class="co"># elementos 3,4,5,6</span>
x[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>)]  <span class="co"># elts 1,3 y 6</span>
x[-<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>)]  <span class="co"># todos elts excepto 1,3 y 6</span></code></pre>
</div>
<div id="ejercicio-1" class="slide section level1">
<h1>Ejercicio 1</h1>
<ul>
<li>crear un vector x con valores 0, 3, 6, 9, 12, 15, 18</li>
</ul>
<ul>
<li>crear un vector y con las palabras {&quot;mis&quot;,&quot;números&quot;,&quot;favoritos&quot;,&quot;son&quot;}</li>
</ul>
<ul>
<li>crear un vector z con todos los elementos de y los 2 últimos elementos de x</li>
</ul>
<ul>
<li>ejecutar <code>typeof(x)</code>, <code>typeof(y)</code> y <code>typeof(z)</code></li>
</ul>
<ul>
<li>crear un vector w con valores el logaritmo de cada elemento de x</li>
</ul>
</div>
<div id="vectores" class="slide section level1">
<h1>Vectores</h1>
<ul>
<li>Veamos algunos ejemplos con vectores</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>)
x +<span class="st"> </span><span class="dv">1</span>  <span class="co">#suma 1 a cada elemento del vector</span>
x/<span class="dv">2</span>  <span class="co">#divide por 2 cada elemento del vector</span>
<span class="kw">length</span>(x)  <span class="co"># número de elementos del vector</span>
<span class="kw">max</span>(x)
<span class="kw">min</span>(x)
<span class="kw">sum</span>(x)  <span class="co">#suma todos los elementos del vector</span>
<span class="kw">log</span>(x)  <span class="co">#aplica la función log() a cada elemento del vector</span></code></pre>
<ul>
<li>Observar que estamos utilizando las primeras funciones de R (length, max, min, ...). Si se desea obtener la ayuda en particular de una función debemos escribir <code>?</code> seguido del nombre de la función</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="st">`</span><span class="dt">?</span><span class="st">`</span>(sum)
<span class="st">`</span><span class="dt">?</span><span class="st">`</span>(mean)</code></pre>
</div>
<div id="vectores-ii" class="slide section level1">
<h1>Vectores (II)</h1>
<ul>
<li>Ahora, veamos como son las operaciones entre vectores</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>)
y &lt;-<span class="st"> </span><span class="dv">4</span>:<span class="dv">6</span>  <span class="co"># también se pueden generar secuencias numéricas sin usar c()</span>
x +<span class="st"> </span>y

x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">4</span>
x +<span class="st"> </span>y  <span class="co"># R da un warning si se suman de diferente longitud</span>

x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">3</span>
y &lt;-<span class="st"> </span><span class="dv">4</span>:<span class="dv">6</span>
x *<span class="st"> </span>y  <span class="co"># producto elemento a elemento</span></code></pre>
</div>
<div id="matrices" class="slide section level1">
<h1>Matrices</h1>
<ul>
<li>Veamos como se crea una matriz en R:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span>:<span class="dv">9</span>, <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
m1

m1[<span class="dv">1</span>, <span class="dv">2</span>]
m1[, <span class="dv">2</span>]
m1[<span class="dv">1</span>, ]
m1[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]</code></pre>
<ul>
<li>Seleccionemos partes de una matriz</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(m1)
m1[<span class="dv">1</span>, <span class="dv">2</span>]
m1[<span class="dv">2</span>, ]  <span class="co"># fila 2, todas columnas</span>
m1[, <span class="dv">1</span>]  <span class="co"># todas las filas, columna 1</span>
m1[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)]  <span class="co"># filas 1,3 y columnas 2,3</span></code></pre>
<ul>
<li>Algunos ejemplos de operaciones con matrices</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">m1 +<span class="st"> </span>m1
m1 *<span class="st"> </span>m1  <span class="co"># de nuevo, producto elemento a elemento</span></code></pre>
</div>
<div id="otras-operaciones-de-interés-con-vectores-y-matrices" class="slide section level1">
<h1>Otras operaciones de interés con vectores y matrices</h1>
<ul>
<li>Al contrario que con los vectores, ciertas operaciones con matrices no son posibles</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">m2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">1</span>:<span class="dv">12</span>, <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">FALSE</span>)
m1 +<span class="st"> </span>m2  <span class="co"># error</span>
m1 *<span class="st"> </span>m2  <span class="co"># error</span></code></pre>
<ul>
<li>¿Y las operaciones usuales de vectores (producto escalar) y matrices (prod. matricial)? Se utiliza el operador <code>%*%</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">x %*%<span class="st"> </span>y

m2 %*%<span class="st"> </span>m1
m1 %*%<span class="st"> </span><span class="kw">t</span>(m2)
m1 %*%<span class="st"> </span>m2</code></pre>
<ul>
<li>Para hallar el determinante y la inversa de una matriz</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">m3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
<span class="kw">det</span>(m3)  <span class="co">#determinante</span>
<span class="kw">solve</span>(m3)  <span class="co">#inversa</span></code></pre>
</div>
<div id="ejercicio-2" class="slide section level1">
<h1>Ejercicio 2</h1>
<ul>
<li>crear una matriz A de 2x2 con la primera fila 2,3 y la segunda 6,7</li>
</ul>
<ul>
<li>crear una matriz b de 2x1 con los elementos 1,5</li>
</ul>
<ul>
<li>resolver la ecuación Ax=b</li>
</ul>
</div>
<div id="operaciones-lógicas-comparaciones" class="slide section level1">
<h1>Operaciones lógicas (comparaciones)</h1>
<ul>
<li>Veamos como se hacen comparaciones en R</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span>
y &lt;-<span class="st"> </span><span class="dv">3</span>
x ==<span class="st"> </span>y  <span class="co"># comparar variables</span>
x &lt;<span class="st"> </span>y
x &gt;<span class="st"> </span>y

x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>)
x ==<span class="st"> </span>y  <span class="co"># comparar vectores</span>
x &lt;<span class="st"> </span>y
x &gt;<span class="st"> </span>y</code></pre>
<ul>
<li>Veamos como obtener los elementos de un vector que satisfacen una condición</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">x[x &gt;<span class="st"> </span>y]  <span class="co"># elementos de x que son mayores que los corresp. de y</span>
y[x &gt;<span class="st"> </span>y]  <span class="co"># elementos de y que son menores que los corresp. de x</span></code></pre>
</div>
<div id="ejercicio-3" class="slide section level1">
<h1>Ejercicio 3</h1>
<ul>
<li>Tenemos un vector x con los elementos 1,2,..,9,10 que identifican a 10 personas (vamos a simularlo con sample(1:10,10))</li>
</ul>
<ul>
<li>Tenemos otro vector y con el peso de estas 10 personas (vamos a simularlo con rnorm(10,75,10))</li>
</ul>
<ul>
<li>Hallar el peso de las personas con id. menor o igual a 5</li>
</ul>
<ul>
<li>Hallar las personas con peso menor de 74 kg (determinar la persona y su peso).</li>
</ul>
</div>
<div id="estructuras-de-datos.-la-instrucción-data.frame" class="slide section level1">
<h1>Estructuras de datos. La instrucción data.frame()</h1>
<ul>
<li>Un conjunto de datos estándar se representa en R como un data.frame</li>
<li>Es una estructura similar a <code>matrix</code></li>
<li>Las filas son las observaciones y las columnas son las variables (numéricas o categóricas)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">datos &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">aula =</span> <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">each =</span> <span class="dv">2</span>), <span class="dt">sexo =</span> <span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">horas =</span> <span class="kw">rnorm</span>(<span class="dv">6</span>, 
    <span class="dv">8</span>, <span class="dv">2</span>))
<span class="kw">dim</span>(datos)  <span class="co"># hay 6 observaciones y 3 variables</span>
datos</code></pre>
<ul>
<li>NOTA: Todas las columnas son de la misma longitud (un data.frame es rectangular, es como una hoja de cálculo)</li>
</ul>
<ul>
<li>Como hemos dicho, un data.frame es similar a una matriz. Por tanto, para acceder a sus elementos lo hacemos de forma parecida.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">datos[<span class="dv">1</span>, ]  <span class="co"># observación 1</span>
datos[, <span class="dv">2</span>]  <span class="co"># variable 2</span>
datos[<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">2</span>]  <span class="co"># ?</span></code></pre>
</div>
<div id="estructuras-de-datos.-la-instrucción-data.frame-ii" class="slide section level1">
<h1>Estructuras de datos. La instrucción data.frame() (II)</h1>
<ul>
<li>A las columnas podemos acceder utilizando su nombre</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">datos[, <span class="st">&quot;sexo&quot;</span>]
datos[, <span class="kw">c</span>(<span class="st">&quot;aula&quot;</span>, <span class="st">&quot;sexo&quot;</span>)]</code></pre>
<p>aunque la más habitual es con el operador <code>$</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">datos$sexo  <span class="co"># la columna sexo (como vector de valores)</span>
datos$sexo[<span class="dv">1</span>:<span class="dv">3</span>]  <span class="co"># los 3 primeros elementos de sexo</span>
datos$sexo[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">6</span>)]  <span class="co"># ?</span></code></pre>
<ul>
<li>Podemos hacer operaciones vectoriales con las variables de un data.frame</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>datos$sexo +<span class="st"> </span>datos$horas
datos$dias &lt;-<span class="st"> </span>datos$horas/<span class="dv">24</span></code></pre>
</div>
<div id="filtrar-conjuntos-de-registros-en-un-data.frame" class="slide section level1">
<h1>Filtrar conjuntos de registros en un data.frame</h1>
<ul>
<li>Supongamos que queremos filtrar aquellas filas del dataset 'datos' que verifican una condición determinada (p.e., las filas tales que var1 sea igual a 2 y las filas con var2 igual a 2).</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">datos_filt1 &lt;-<span class="st"> </span><span class="kw">subset</span>(datos, aula ==<span class="st"> </span><span class="dv">2</span>)  <span class="co"># filas del aula 2</span>
datos_filt1
<span class="co"># cond&lt;-datos$aula==2 datos_filt1&lt;-datos[cond,] # filas con var1=2</span>
<span class="co"># datos_filt1</span>

datos_filt2 &lt;-<span class="st"> </span><span class="kw">subset</span>(datos, sexo ==<span class="st"> </span><span class="dv">1</span>)  <span class="co"># filas del sexo 1</span>
datos_filt2
<span class="co"># cond&lt;-datos$sexo==1 datos_filt2&lt;-datos[cond,] # filas con sexo=1</span>
<span class="co"># datos_filt2</span></code></pre>
<ul>
<li>Si queremos combinar condiciones utilizamos los operadores <code>&amp;</code> (AND) y <code>|</code> (OR). Por ejemplo:</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">datos_filt3 &lt;-<span class="st"> </span><span class="kw">subset</span>(datos, aula ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>sexo ==<span class="st"> </span><span class="dv">2</span>)  <span class="co"># filas con aula=1 y sexo=2</span>
<span class="co"># cond&lt;-(datos$var1==2 &amp; datos$var2==2) datos_filt3&lt;-datos[cond,] # filas</span>
<span class="co"># con var1=1 y var2=2 datos_filt3</span>

datos_filt4 &lt;-<span class="st"> </span><span class="kw">subset</span>(datos, aula ==<span class="st"> </span><span class="dv">1</span> |<span class="st"> </span>sexo ==<span class="st"> </span><span class="dv">2</span>)  <span class="co"># filas con aula=1 o sexo=2</span>
<span class="co"># cond&lt;-(datos$var1==2 | datos$var2==2) datos_filt4&lt;-datos[cond,] # filas</span>
<span class="co"># con var1=1 ó var2=2 datos_filt4</span></code></pre>
</div>
<div id="ejercicio-4" class="slide section level1">
<h1>Ejercicio 4</h1>
<pre class="sourceCode r"><code class="sourceCode r">mascotas &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">animal =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;gato&quot;</span>, <span class="st">&quot;perro&quot;</span>, <span class="st">&quot;mono&quot;</span>), <span class="dt">each =</span> <span class="dv">2</span>), <span class="dt">sexo =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;M&quot;</span>, 
    <span class="st">&quot;H&quot;</span>), <span class="dv">3</span>), <span class="dt">peso =</span> <span class="kw">rnorm</span>(<span class="dv">6</span>, <span class="dv">15</span>, <span class="dv">5</span>))</code></pre>
<ul>
<li>Filtro por una variable: Filtrar las 'mascotas' de tipo 'gato'. ¿Cuántos animales hay?</li>
</ul>
<ul>
<li>Suma agrupada: Hallar la suma de todos los pesos de cada animal (animal='perro', animal='gato',animal='mono'). ¿Cuál es el máximo de las sumas agrupadas por animal?</li>
</ul>
<ul>
<li>Media de una variable por grupos: Hallar el peso medio de cada animal.</li>
</ul>
</div>
<div id="resúmenes-por-filas-y-columnas" class="slide section level1">
<h1>Resúmenes por filas y columnas</h1>
<ul>
<li>Se pueden sumar los valores de las columnas o las filas con las siguientes instrucciones</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(datos)
<span class="kw">rowSums</span>(datos)  <span class="co">#sólo funciona si todas las variables son numéricas</span></code></pre>
<ul>
<li>Sin embargo, a veces queremos sumar los valores de una variable agrupados de acuerdo a una variable categórica. Por ejemplo, sumar todas las horas para cada aula o cada sexo en 'datos'.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">by</span>(datos[, <span class="st">&quot;horas&quot;</span>], datos[, <span class="st">&quot;aula&quot;</span>], sum)  <span class="co"># suma las horas para cada aula</span>
<span class="kw">by</span>(datos[, <span class="dv">3</span>], datos[, <span class="dv">1</span>], sum)  <span class="co"># cuidado con esta forma que puede dar lugar a errores</span></code></pre>
<ul>
<li>En R puede haber múltiples instrucciones para sumar por grupos.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">aggregate</span>(horas ~<span class="st"> </span>aula, sum, <span class="dt">data =</span> datos)  <span class="co"># utilizando una fórmula</span></code></pre>
</div>
<div id="ejercicio-5" class="slide section level1">
<h1>Ejercicio 5</h1>
<ul>
<li>Suma agrupada: Hallar la suma de todos los pesos de cada animal (animal='perro', animal='gato',animal='mono').</li>
</ul>
<ul>
<li>Media de una variable por grupos: Hallar el peso medio de cada animal.</li>
</ul>
</div>
<div id="librería-rcommander-y-técnicas-de-análisis-estadístico." class="slide section level1">
<h1><br/><br/><br/><br/>Librería RCommander y técnicas de análisis estadístico.</h1>
</div>
<div id="qué-es-rcommander" class="slide section level1">
<h1>¿Qué es RCommander?</h1>
<ul>
<li>Es una interfaz gráfica de usuario (GUI)</li>
</ul>
<ul>
<li>Facilita el manejo de R y permite generar instrucciones de R</li>
</ul>
<ul>
<li>Incluye la posibilidad de realizar distintos tipos de análisis (análisis exploratorio, distribuciones de probabilidad, inferencia paramétrica y no paramétrica, análisis de la varianza de uno o varios factores,....)</li>
</ul>
<ul>
<li>Es una librería que no está incluida en la instalación base de R</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;Rcmdr&quot;</span>)</code></pre>
<ul>
<li>Una vez instalada, sólo hace falta iniciarla en cada nueva sessión de R de la siguiente forma</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Rcmdr)  <span class="co"># tarda un poco puesto que conviene instalar las librerías adicionales que solicita</span></code></pre>
<ul>
<li>Si se cierra R-Commander (Rcmdr) pero no la sesión de R, se vuelve a cargar</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Commander</span>()</code></pre>
</div>
<div id="aspecto-de-la-interfaz-de-r-commander" class="slide section level1">
<h1>Aspecto de la interfaz de R Commander</h1>
<ul>
<li>La interfaz de R commander tiene varias partes principales
<ul>
<li>En la parte superior se presentan una serie de opciones de menú (Fichero, Editar, ...)</li>
<li>A continuación, hay dos ventanas principales:
<ul>
<li>R Script, donde aparecen todas las instrucciones que se generarán cuando seleccionemos opciones del menú superior.</li>
<li>Salida, donde se presenta en formato texto el resultado de la ejecución de las diferentes opciones del menú</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="directorio-de-trabajo-scripts-resultados-y-workspace-de-r" class="slide section level1">
<h1>Directorio de trabajo, scripts, resultados y workspace de R</h1>
<ul>
<li>El menú 'Fichero' sirve para gestionar las instrucciones a ejecutar, los objetos creados en R, los resultados generados, etc... pero NO permite cargar conjuntos de datos para el análisis.
<ul>
<li>El directorio de trabajo representa el directorio local donde queremos trabajar (donde estan los archivos a cargar, donde queremos guardar los scripts, ...)</li>
<li>Las instrucciones de la ventan R Script (cargarlas o guardarlas)</li>
<li>Los resultados de la ventana Salida (guardar)</li>
<li>El entorno de trabajo (workspace) con todas las variables que tenemos creadas</li>
</ul></li>
</ul>
<ul>
<li>En principio, las opciones más importantes de este menú sería 'Cambiar directorio de trabajo' (al comenzar a utilizar Rcmdr) y 'Guardar las instrucciones' (al finalizar nuestra sesión de Rcmdr).</li>
</ul>
<ul>
<li>En cualquier caso, al cerrar Rcmdr también nos preguntará si queremos guardar el script y el espacio de trabajo.</li>
</ul>
</div>
<div id="distribuciones-de-probabilidad" class="slide section level1">
<h1>Distribuciones de probabilidad</h1>
<ul>
<li>El menú 'Distribuciones' dispone de diversas funciones para estudiar diferentes tipos de distribuciones. En particular
<ul>
<li>Se pueden obtener los cuantiles teóricos para una distribución (por ejemplo, para hallar cual es el valor crítico <span class="math"><em>z</em><sub><em>α</em> / 2</sub></span> de una normal)</li>
<li>Se pueden obtener las probabilidades <span class="math"><em>P</em><em>r</em>(<em>Z</em> &lt; <em>z</em>)</span></li>
<li>Representar las funciones de densidad y de probabilidad</li>
<li>Generar una muestra simulada para una distribución determinada</li>
</ul></li>
</ul>
</div>
<div id="ejercicio-5-1" class="slide section level1">
<h1>Ejercicio 5</h1>
<ul>
<li>Cuantiles teóricos: Obtener un vector <code>y</code> con los cuantiles 25%,50%,75%,100% de la normal de media 0 y sd. 1.</li>
</ul>
<ul>
<li>Obtener una muestra de 100 valores aleatorios de una uniforme entre 0 y 1.</li>
</ul>
<ul>
<li>Cuantiles muestrales: Obtener un vector <code>x</code> con los cuantiles 25%,50%,75%,100% de la muestra (se utiliza la función <code>quantile()</code>).</li>
</ul>
<ul>
<li>Hacer un <code>plot(x,y); abline(0,1)</code></li>
</ul>
</div>
<div id="importar-conjuntos-de-datos-i" class="slide section level1">
<h1>Importar conjuntos de datos (I)</h1>
<ul>
<li>El menú Datos nos permite importar conjuntos de datos desde varios formatos (txt, SPSS, Excel, ...). Vamos a cargar el conjunto de datos 'ddt.txt':
<ul>
<li>group: Grupo de observaciones (mediciones en dos temporadas)</li>
<li>location: Código del lugar de captura (de 1 a 3)</li>
<li>location_name: Nombre del lugar (afluente, medio, desembocadura)</li>
<li>species: Código de especie (de 1 a 2)</li>
<li>species_name: Nombre de la especie del pez (buffalo, catfish)</li>
<li>length: Longitud del pez(en cm.)</li>
<li>weight: Peso pez (en grs.)</li>
<li>DDT_conc: Concentración de DDT (% de peso) medida</li>
</ul></li>
</ul>
<ul>
<li>Se puede descargar el archivo en local y luego importarlo pero también existe la posbilidad de leer directamente desde internet</li>
</ul>
<pre><code>  * http://dl.dropboxusercontent.com/u/17677514/ddt.txt</code></pre>
</div>
<div id="importar-conjuntos-de-datos-ii" class="slide section level1">
<h1>Importar conjuntos de datos (II)</h1>
<ul>
<li>La opción 'Conjunto de datos activo' permite:
<ul>
<li>Filtrar observaciones (filas) del conjunto de datos</li>
<li>Ver nombres de las variables (columnas) del conjunto de datos</li>
<li>Guardar el conjunto de datos (en formato R) o exportar a formato texto plano</li>
</ul></li>
</ul>
<ul>
<li>La opción 'Modificar variables del conjunto de datos activo' permite:
<ul>
<li>Renombrar las variables</li>
<li>Calcular nuevas variables</li>
<li>Tipificar o estandarizar las variables</li>
<li>Reordenar niveles de un factor</li>
</ul></li>
</ul>
</div>
<div id="análisis-estadísticos" class="slide section level1">
<h1>Análisis estadísticos</h1>
<ul>
<li>El menú Estadísticos nos permite realizar diversos análisis estadísticos.</li>
</ul>
<ul>
<li>En la opción 'Resúmenes' podemos:
<ul>
<li>Obtener resúmenes estadísticos de las variables conjunto de datos. Estos resúmenes se pueden hacer por grupos de una variable factor.</li>
<li>Hallar correlaciones entre variables (Pearson, Spearman, parcial).</li>
<li>Realizar test de correlaciones significativas y de normalidad de las variables.</li>
</ul></li>
</ul>
<ul>
<li>La opción 'Gráficas' nos permite complementar los análisis mediante
<ul>
<li>Gráficos histograma para estudiar la distribución de los datos</li>
<li>Diagramas de caja para analizar la varianza de las variables</li>
</ul></li>
</ul>
</div>
<div id="tablas-de-contingencia-y-tests-de-proporciones" class="slide section level1">
<h1>Tablas de contingencia y tests de proporciones</h1>
<ul>
<li>En la opción 'Tablas de contingencia' podemos generar tablas de contingencia (de doble o múltiple entrada) para analizar relaciones entre dos o más variables factor.
<ul>
<li>REQUISITOS: Es preciso tener, al menos, 2 variables factor para generar este tipo de tablas.</li>
</ul></li>
</ul>
<ul>
<li>A partir de las tablas de doble entrada se pueden realizar tests de independencia de la chi-cuadrado</li>
</ul>
<ul>
<li>En la opción 'Proporciones' podemos realizar pruebas sobre la proporción de éxitos (o de un grupo determinado) en una población
<ul>
<li>REQUISITOS: Es preciso tener 1 variable factor con 2 niveles para realizar este test.</li>
</ul></li>
</ul>
</div>
<div id="ejercicio-5-2" class="slide section level1">
<h1>Ejercicio 5</h1>
<ul>
<li>Realizar un resumen descriptivo de 'DDT_conc' para cada uno de los 2 grupos de observaciones.</li>
</ul>
<ul>
<li>Realizar un test para comparar si la proporción de observaciones en el grupo 1 es igual a la del grupo 2</li>
</ul>
<ul>
<li>Realizar una tabla de contingencia para comparar los 2 grupos de observaciones con las 2 especies de peces.</li>
</ul>
<ul>
<li>PISTA: La variable 'group' ha sido cargada en R como variable numérica y debería ser un factor.</li>
</ul>
<ul>
<li>Realizar un histograma comparativo del 'DDT_conc' del grupo 1 con el grupo 2</li>
</ul>
</div>
<div id="nivel-avanzado-gráficos-más-complejos" class="slide section level1">
<h1>Nivel avanzado: Gráficos más complejos</h1>
<ul>
<li>Se puede hacer un gráfico histograma combinado con diagrama de cajas y añadir una curva de densidad normal</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(devtools)
<span class="kw">source_gist</span>(<span class="st">&quot;1e7ee71e79346ffdd5a5&quot;</span>)
<span class="kw">plotHistBox</span>(ddt$length)</code></pre>
<p><img src="figure/plot6a1.png" /> <img src="figure/plot6a2.png" /></p>
</div>
<div id="nivel-avanzado-gráficos-más-complejos-1" class="slide section level1">
<h1>Nivel avanzado: Gráficos más complejos</h1>
<ul>
<li>Los gráficos histogramas también se pueden combinar</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">h1 &lt;-<span class="st"> </span><span class="kw">hist</span>(ddt$weight, <span class="dt">col =</span> <span class="st">&quot;grey60&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Histograma de weight&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;weight&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))
<span class="kw">with</span>(ddt, <span class="kw">hist</span>(weight[species ==<span class="st"> </span><span class="dv">1</span>], <span class="dt">breaks =</span> h1$breaks, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Histograma de weight&quot;</span>, 
    <span class="dt">xlab =</span> <span class="st">&quot;weight&quot;</span>))
<span class="kw">with</span>(ddt, <span class="kw">hist</span>(weight[species ==<span class="st"> </span><span class="dv">2</span>], <span class="dt">breaks =</span> h1$breaks, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>))

<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">sort</span>(<span class="kw">levels</span>(ddt$species_name), <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, 
    <span class="st">&quot;red&quot;</span>))</code></pre>
<div class="figure">
<img src="figure/plot6b.png" />
</div>
</div>
<div id="otros-gráficos-en-rcmdr" class="slide section level1">
<h1>Otros gráficos en Rcmdr</h1>
<ul>
<li>Los gráficos de cajas y bigotes</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(ddt$DDT_conc, <span class="dt">main =</span> <span class="st">&quot;Diagrama box-and-whisker de DDT_conc&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</code></pre>
<div class="figure">
<img src="figure/plot7a.png" />
</div>
<ul>
<li>Los gráficos de comparación de cuantiles (qq-plot)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqnorm</span>(ddt$DDT_conc, <span class="dt">main =</span> <span class="st">&quot;Q-q plot de DDT_conc&quot;</span>)
<span class="kw">qqline</span>(ddt$DDT_conc, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</code></pre>
<div class="figure">
<img src="figure/plot7b.png" />
</div>
</div>
<div id="otros-gráficos-en-rcmdr-1" class="slide section level1">
<h1>Otros gráficos en Rcmdr</h1>
<ul>
<li>Los gráficos 'Diagrama de dispersión' permiten representar 2 variables y añadir la información de un grupo.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(lattice)
<span class="kw">scatterplot</span>(length ~<span class="st"> </span>weight |<span class="st"> </span>group, <span class="dt">reg.line =</span> lm, <span class="dt">smooth =</span> <span class="ot">FALSE</span>, 
    <span class="dt">spread =</span> <span class="ot">FALSE</span>, <span class="dt">boxplots =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="fl">0.5</span>, <span class="dt">by.groups =</span> <span class="ot">TRUE</span>, 
    <span class="dt">reset.par =</span> <span class="ot">FALSE</span>, <span class="dt">data =</span> ddt)</code></pre>
<p><img src="figure/plot8a1.png" /> <img src="figure/plot8a2.png" /></p>
</div>
<div id="otros-gráficos-en-rcmdr-2" class="slide section level1">
<h1>Otros gráficos en Rcmdr</h1>
<ul>
<li>Otro gráfico de 2 variables es 'Gráfica XY'</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(lattice)
<span class="kw">xyplot</span>(length ~<span class="st"> </span>weight, <span class="dt">groups =</span> group, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, 
    <span class="dt">auto.key =</span> <span class="kw">list</span>(<span class="dt">border =</span> <span class="ot">TRUE</span>), <span class="dt">data =</span> ddt)</code></pre>
<div class="figure">
<img src="figure/plot8b.png" />
</div>
</div>
<div id="otros-gráficos-en-rcmdr-3" class="slide section level1">
<h1>Otros gráficos en Rcmdr</h1>
<ul>
<li>Los gráficos 'Matriz de diagrama de dispersión' permiten visualizar múltiples variables</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">scatterplotMatrix</span>(~DDT_conc +<span class="st"> </span>length +<span class="st"> </span>weight, <span class="dt">reg.line =</span> lm, <span class="dt">smooth =</span> <span class="ot">FALSE</span>, 
    <span class="dt">spread =</span> <span class="ot">FALSE</span>, <span class="dt">span =</span> <span class="fl">0.5</span>, <span class="dt">id.n =</span> <span class="dv">0</span>, <span class="dt">diagonal =</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">data =</span> ddt)</code></pre>
<div class="figure">
<img src="figure/plot9.png" />
</div>
</div>
<div id="otros-gráficos-en-rcmdr-4" class="slide section level1">
<h1>Otros gráficos en Rcmdr</h1>
<ul>
<li>Los 'Gráficos de medias' son muy útiles en ANOVAs</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(Rcmdr)
<span class="kw">plotMeans</span>(ddt$DDT_conc, ddt$species_name, <span class="dt">error.bars =</span> <span class="st">&quot;conf.int&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</code></pre>
<div class="figure">
<img src="figure/plot10.png" />
</div>
</div>
<div id="tests-de-medias-y-de-varianzas" class="slide section level1">
<h1>Tests de medias y de varianzas</h1>
<ul>
<li>En la opción 'Medias' podemos realizar pruebas sobre la media estadística de una o más poblaciones.
<ul>
<li>El test “Test t para una muestra” corresponde a la prueba clásica sobre la media de una población cuando la varianza es desconocida.</li>
<li>Los “Test t para muestras independientes” y “Test t para datos relacionados” permiten comparar, dadas dos muestras (o dos grupos), las medias de sus respectivas poblaciones.</li>
<li>REQUISITOS: Para realizar el test de muestras independientes, Rcmdr necesita una variable factor con dos niveles para diferenciar cada muestra.</li>
<li>Los tests &quot;ANOVA&quot; nos permiten comparar medias para un mayor número de niveles o grupos (2 ó más).</li>
</ul></li>
</ul>
<ul>
<li>En la opción 'Varianzas' se puede analizar la varianza estadística de una o más poblaciones
<ul>
<li>El test F-ratio contrasta, dadas dos muestras, el cociente de varianzas de sus respectivas poblaciones.</li>
<li>REQUISITOS: De nuevo, en Rcmdr es preciso una variable factor con dos niveles para diferenciar cada muestra.</li>
<li>Otros tests que permiten comparar la igualdad de varianzas entre mayor número de niveles son el test de Bartlett y el de Levene.</li>
</ul></li>
</ul>
</div>
<div id="esquema-de-aplicación-de-test-de-comparación-de-medias" class="slide section level1">
<h1>Esquema de aplicación de test de comparación de medias</h1>
<object data="figure/test_flowchart.svg" type="image/svg+xml" 
  width="100%" height="80%" title="Esquema de t-test"> 
</object>


</div>
<div id="esquema-de-aplicación-de-test-de-comparación-de-medias-medidas-repetidas" class="slide section level1">
<h1>Esquema de aplicación de test de comparación de medias (medidas repetidas)</h1>
<object data="figure/test2_flowchart.svg" type="image/svg+xml" 
  width="100%" height="80%" title="Esquema de t-test"> 
</object>

</div>
<div id="ejercicio-6" class="slide section level1">
<h1>Ejercicio 6</h1>
<p>Comparar el peso de los peces del grupo 1 con el peso de los del grupo 2.</p>
<ul>
<li>1º PASO: ¿Se asume normalidad de la variable peso?</li>
</ul>
<div class="figure">
<img src="figure/plot1.png" />
</div>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">shapiro.test</span>(ddt$weight)</code></pre>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  ddt$weight
## W = 0.9727, p-value = 0.009211</code></pre>
<p>Si hay dudas en la normalidad, el t-test no se puede aplicar y hay que acudir a alternativas no paramétricas.</p>
</div>
<div id="ejercicio-6-1" class="slide section level1">
<h1>Ejercicio 6</h1>
<p>Comparar el peso de los peces del grupo 1 con el peso de los del grupo 2.</p>
<ul>
<li>2º PASO: ¿Se asume igualdad de varianzas de peso entre los grupos?<br /><img src="figure/plot2.png" /></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bartlett.test</span>(weight ~<span class="st"> </span>group, <span class="dt">data =</span> ddt)</code></pre>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  weight by group
## Bartlett&#39;s K-squared = 0.0095, df = 1, p-value = 0.9225</code></pre>
<p>Si las varianzas entre grupos son iguales, se debe especificar en opciones del t-test (aprox. Welch).</p>
</div>
<div id="tests-no-paramétricos" class="slide section level1">
<h1>Tests no paramétricos</h1>
<ul>
<li>En la opción 'Tests no paramétricos' se pueden realizar distintas pruebas de estadísticas cuando no se verifican ciertas hipótesis.
<ul>
<li>El “test de Wilcoxon” es equivalente al t-test para muestras independientes cuando no se puede asumir normalidad en los datos.</li>
<li>El “test de Kruskal-Wallis” y el “test de Friedman” son tests basados en el rango muestral de las observaciones (equivalentes al ANOVA cuando no se puede asumir normalidad).</li>
</ul></li>
</ul>
<ul>
<li>EJEMPLO: Comparar 'DDT_conc' de los peces del grupo 1 con los del grupo 2.</li>
</ul>
</div>
<div id="modelos-estadísticos-anova" class="slide section level1">
<h1>Modelos estadísticos: ANOVA</h1>
<ul>
<li>La opción 'Medias' permite realizar el análisis de varianza de uno o varios factores para comparar las medias de grupos (similar al t-test pero con 2 o más niveles en las variables factor).</li>
</ul>
<ul>
<li>La opción 'Tests no paramétricos', con los “test de Kruskal-Wallis” y el “test de Friedman”, son pruebas no paramétricas alternativas al ANOVA.</li>
</ul>
<ul>
<li>Junto a la 'Gráfica de las medias' permite llevar a cabo un análisis comparativo de los efectos de los factores y sus interacciones en un modelo.</li>
</ul>
</div>
<div id="esquema-de-aplicación-de-test-anova" class="slide section level1">
<h1>Esquema de aplicación de test ANOVA</h1>
<object data="figure/anova_flowchart.svg" type="image/svg+xml" 
  width="100%" height="80%" title="Esquema de ANOVA"> 
</object>

</div>
<div id="ejercicio-7" class="slide section level1">
<h1>Ejercicio 7</h1>
<ul>
<li>EJEMPLO: Analizar las diferencias en el peso de los peces entre las diferentes localizaciones.</li>
</ul>
<ul>
<li>1º PASO: ¿Hay diferencias entre todos los niveles (especies)?</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Comprobamos si la varianza es constante</span>
<span class="kw">bartlett.test</span>(weight ~<span class="st"> </span>location_name, <span class="dt">data =</span> ddt)</code></pre>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  weight by location_name
## Bartlett&#39;s K-squared = 1.418, df = 2, p-value = 0.4921</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># En caso de homoc. podemos hacer anova</span>
anova.mod1 &lt;-<span class="st"> </span><span class="kw">aov</span>(weight ~<span class="st"> </span>location_name, <span class="dt">data =</span> ddt)
<span class="kw">summary</span>(anova.mod1)</code></pre>
<pre><code>##                Df   Sum Sq Mean Sq F value Pr(&gt;F)  
## location_name   2   622760  311380    2.48  0.087 .
## Residuals     129 16175534  125392                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Si no se asume var. cte. o no hay normalidad, recurrimos al test K.-W.</span>
<span class="kw">kruskal.test</span>(weight ~<span class="st"> </span>location_name, <span class="dt">data =</span> ddt)</code></pre>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  weight by location_name
## Kruskal-Wallis chi-squared = 4.021, df = 2, p-value = 0.1339</code></pre>
</div>
<div id="ejercicio-7-1" class="slide section level1">
<h1>Ejercicio 7</h1>
<ul>
<li>EJEMPLO: Analizar las diferencias en el peso de los peces entre las diferentes localizaciones.</li>
</ul>
<ul>
<li>2º PASO: ¿Cómo son las diferencias 2 a 2? (sólo si hay más de 2 niveles en el factor)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">anova.mod1 &lt;-<span class="st"> </span><span class="kw">aov</span>(weight ~<span class="st"> </span>location_name, <span class="dt">data =</span> ddt)
<span class="kw">summary</span>(<span class="kw">glht</span>(anova.mod1, <span class="dt">linfct =</span> <span class="kw">mcp</span>(<span class="dt">location_name =</span> <span class="st">&quot;Tukey&quot;</span>)))  <span class="co"># pairwise tests</span></code></pre>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: aov(formula = weight ~ location_name, data = ddt)
## 
## Linear Hypotheses:
##                           Estimate Std. Error t value Pr(&gt;|t|)  
## CursoM - Afluente == 0       105.4       74.8    1.41    0.339  
## Desemboca - Afluente == 0    170.5       77.3    2.21    0.074 .
## Desemboca - CursoM == 0       65.0       74.8    0.87    0.660  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="figure">
<img src="figure/plot3.png" />
</div>
</div>
<div id="modelos-estadísticos-anova-de-varios-factores" class="slide section level1">
<h1>Modelos estadísticos: ANOVA de varios factores</h1>
<ul>
<li>En el ANOVA de múltiples factores es posible analizar no sólo los efectos simples sino también las interacciones.</li>
</ul>
<div class="figure">
<img src="figure/plot4.png" />
</div>
</div>
<div id="modelos-estadísticos-regresión" class="slide section level1">
<h1>Modelos estadísticos: Regresión</h1>
<ul>
<li>La opción 'Ajuste de modelos' dispone de múltiples posibilidades para la creación de modelos estadísticos.</li>
</ul>
<ul>
<li>Además, en la opción 'Modelos' se pueden llevar a cabo muchos análisis habituales en el estudio de los mismos.</li>
</ul>
<ul>
<li>En particular, veamos como determinar un modelo de regresión para estudiar la relación entre la longitud y el peso de los peces.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">regmod<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(weight ~<span class="st"> </span>length, <span class="dt">data =</span> ddt)
<span class="kw">summary</span>(regmod<span class="fl">.1</span>)</code></pre>
<pre><code>## 
## Call:
## lm(formula = weight ~ length, data = ddt)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1034.0  -203.6   -58.8   179.3   870.5 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -886.11     229.73   -3.86  0.00018 ***
## length         44.57       5.16    8.64  1.7e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 286 on 130 degrees of freedom
## Multiple R-squared:  0.365,  Adjusted R-squared:  0.36 
## F-statistic: 74.7 on 1 and 130 DF,  p-value: 1.73e-14</code></pre>
</div>
<div id="análisis-de-modelos" class="slide section level1">
<h1>Análisis de modelos</h1>
<ul>
<li>Podemos obtener la correlación de las variables de interés en 'Estadísticos-&gt;Resúmenes'.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(ddt[, <span class="kw">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;weight&quot;</span>)], <span class="dt">use =</span> <span class="st">&quot;complete&quot;</span>)</code></pre>
<pre><code>##        length weight
## length 1.0000 0.6041
## weight 0.6041 1.0000</code></pre>
<ul>
<li>La representación gráfica de un modelo simple es posible en 'Gráficas-&gt;Diagrama de dispersión' seleccionando la opción de mínimos cuadrados. Pero se puede hacer también con <code>plot()</code> y <code>abline()</code></li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(ddt$length, ddt$weight, <span class="dt">main =</span> <span class="st">&quot;Weight vs. length&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;lenght&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;weight&quot;</span>, 
    <span class="dt">pch =</span> <span class="dv">20</span>)
<span class="kw">abline</span>(regmod<span class="fl">.1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="st">&quot;dashed&quot;</span>)</code></pre>
<div class="figure">
<img src="figure/plot5.png" />
</div>
</div>
<div id="análisis-de-modelos-1" class="slide section level1">
<h1>Análisis de modelos</h1>
<ul>
<li>Con el menú 'Modelos-&gt;Gráficas-&gt;Gráficas básicas de diagnóstico' se pueden obtener una serie de gráficos útiles para el diagnóstico de las hipótesis habituales (homocedasticidad, normalidad, observaciones atípicas)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(regmod<span class="fl">.1</span>)</code></pre>
<div class="figure">
<img src="figure/plot6.png" />
</div>
</div>
<div id="ejercicio-8" class="slide section level1">
<h1>Ejercicio 8</h1>
<ul>
<li>Parece que el modelo <span class="math"><em>w</em><em>e</em><em>i</em><em>g</em><em>h</em><em>t</em> = <em>β</em><sub>0</sub> + <em>β</em><sub>1</sub><em>l</em><em>e</em><em>n</em><em>g</em><em>t</em><em>h</em> + <em>ε</em></span> presenta problemas.</li>
</ul>
<ul>
<li>SUGERENCIA: Transformar variables <span class="math"><em>l</em><em>e</em><em>n</em><em>g</em><em>t</em><em>h</em> ⇒ <em>l</em><em>e</em><em>n</em><em>g</em><em>t</em><em>h</em><sup>3</sup></span> y <span class="math"><em>w</em><em>e</em><em>i</em><em>g</em><em>h</em><em>t</em> ⇒ <em>s</em><em>q</em><em>r</em><em>t</em>(<em>w</em><em>e</em><em>i</em><em>g</em><em>h</em><em>t</em>)</span> y volver a hacer el ajuste.</li>
</ul>
<ul>
<li>En Rcmdr se encuentran disponibles otros análisis útiles en regresión (Breusch-Pagan para la homocedasticidad, Durbin-Watson para la independencia).</li>
</ul>
</div>
<div id="nivel-avanzado-intervalos-de-confianza-y-predicción-de-la-regresión" class="slide section level1">
<h1>Nivel avanzado: Intervalos de confianza y predicción de la regresión</h1>
<ul>
<li>Para los modelos lineales simples, se pueden representar los intervalos de confianza y predición de la recta</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">ddt$length<span class="fl">.3</span> &lt;-<span class="st"> </span>ddt$length^<span class="dv">3</span>
ddt$sqrt.weight &lt;-<span class="st"> </span><span class="kw">sqrt</span>(ddt$weight)
<span class="kw">source_gist</span>(<span class="st">&quot;f9b06d411675c1702ccc&quot;</span>)
<span class="kw">plotConf</span>(sqrt.weight ~<span class="st"> </span>length<span class="fl">.3</span>, ddt)</code></pre>
<div class="figure">
<img src="figure/plot11.png" />
</div>
</div>
<div id="modelos-estadísticos-clustering" class="slide section level1">
<h1>Modelos estadísticos: Clustering</h1>
<ul>
<li>La opción 'Análisis dimensional-&gt;Análisis de agrupación' permite aplicar técnicas de cluster.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(devtools)
<span class="kw">source_gist</span>(<span class="st">&quot;a4b2ed204d01bc12d952&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">plotCluster</span>(<span class="dv">1</span>, ddt[, <span class="kw">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;DDT_conc&quot;</span>)], ddt$species_name)
<span class="kw">plotCluster</span>(<span class="dv">2</span>, ddt[, <span class="kw">c</span>(<span class="st">&quot;length&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;DDT_conc&quot;</span>)], ddt$species_name)</code></pre>
<div class="figure">
<img src="figure/plot12.png" />
</div>
</div>
</body>
</html>
